## Takeaway
- Password found is reused for `root` user in `mysql` database.
## Metadata
- Add `192.168.216.223 milan` to `/etc/hosts`. 
	- Visiting `http://milan:60001/catalog/` reveals  that it is using `osCommerce`. ![[Pasted image 20240311203157.png]]
	- `CHANGELOG` under `http://milan:60001/docs` reveals that it is probably running version `v2.3.4.1`.![[Pasted image 20240311203330.png]]
	- It is vulnerable to RCE.![[Pasted image 20240311204102.png]]
- Credential `oscuser: 7NVLVTDGJ38HM2TQ` for `MySQL` can be found in `/var/www/html/oscommerce/catalog/admin/includes/configure.php`.
	- Password is reused for `MySQL` root user. Exfiltrate more users' hashes from `froxlor` databases. Run `hashcat -m 7400 creds.hash /usr/share/wordlists/rockyou.txt --force` to obtain credential as `flybike:Christopher`.![[Pasted image 20240311233336.png]]
- There is indeed a `froxlor` instance listening at port `60002` where the newly discovered credential can be used.![[Pasted image 20240312150529.png]]
	- However, although it is listening on all addresses but it is only available locally probably due to firewall restriction.
		- Spin up `reverse-ssh` on our end and run `ssh -N -R 127.0.0.1:60002:127.0.0.1:60002 whatever@192.168.45.242` to set up remote port forward.
	- The version of `froxlor` is `0.10.29.1` which is vulnerable to not only `RCE` but also `PrivEsc`.![[Pasted image 20240312151027.png]]
		- https://www.exploit-db.com/exploits/50502
# Exploitation
- Run `searchsploit -m php/webapps/44374.py` and modify as the image shows: ![[Pasted image 20240311204640.png]]
- Finally, run `` navigate to `http://milan:60001/catalog/install/includes/configure.php` to receive a reverse shell call back.
# PrivEsc
- Following the instruction on https://www.exploit-db.com/exploits/50502
	- First add new admin user since we have root access to `MySQL` database.
	- Login as new admin, and use  `config files rebuild` 2 times to spawn a root reverse shell.
# Beyond Root
- Only allow inbound traffic to port `80, 443, 60001` and that's why we need port forwarding  to access `60002`.![[Pasted image 20240312151610.png]]
- Only allow outbound traffic to port `22, 80, 443`.![[Pasted image 20240312151619.png]]
# Credentials
- `Mysql`:
	- `oscuser`: 7NVLVTDGJ38HM2TQ
- `flybike`:Christopher
	- for `froxlor` Login Page
	- sarah@skylark.local