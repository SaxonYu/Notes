## Takeaway
- _Rails common web vulnerability_ will lead us [here](https://guides.rubyonrails.org/v2.3.11/security.html) specifically the [Mass Assignment](https://guides.rubyonrails.org/v2.3.11/security.html#mass-assignment) vulnerability which looks promising. 
	- How we bypassed Email Verification.
## Metadata
- After register a new user and attempt to login at port `80`, one will encounter `Account Confirmation` page.![[Pasted image 20240322160422.png]]
	- Intercept the `Edit EMAIL` API call with `burpsuite` will identify there is a field called `confirmed`.![[Pasted image 20240322160557.png]]
	- Smuggle `user%5Bconfirmed%5D=true` into the POST request will make `confirmed` field equal to `true`, hence allowing us to login.![[Pasted image 20240322160822.png]]
- Now, after login, one will be presented with a file manager.
	- Looking at the page it allows `Arbitrary File Upload`.![[Pasted image 20240322161046.png]]
	- If we upload a `webshell` and try to access it, one will instead download it by navigate to `http://192.168.222.231/?cwd=&file=webshell.php&download=true`.![[Pasted image 20240322161213.png]]
		- However, the `GET` parameter `cwd` and `file` is interesting and potentially vulnerable to `Directory Traversal`. 
		- If we navigate to `http://192.168.222.231/?cwd=../../../../../../`, one can identify it is indeed vulnerable to `Direcotry Traversal`.![[Pasted image 20240322161511.png]]
# Exploitation
- Navigate to `http://192.168.222.231/?cwd=../../../../../../home/remi/.ssh` and upload `authorized_keys`.![[Pasted image 20240322161626.png]]
- Login with `ssh remi@192.168.222.231 -i ../.ssh/id_rsa`
# PrivEsc
- Run `ssh -i root -o IdentitiesOnly=yes  root@127.0.0.1`