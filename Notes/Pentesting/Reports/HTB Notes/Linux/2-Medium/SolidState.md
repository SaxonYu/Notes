## Takeaway
- Use `telnet` rather than `nc` for more stable connection to `pop3` server.
- emails can sometimes contain sensitive information. Make sure to enumerate them if access is possible.
## Metadata
- One can identify one of the company email as `webadmin@solid-state-security.com`.![[Pasted image 20231229144417.png]]
- Port 4555 is running `JAMES Remote Administration Tool 2.3.2` and using default credential pair `root:root`.![[Pasted image 20231229145240.png]]
	- With access to `JAMES Remote Administration Tool` as `root`, we can identify a few existing users and also free to change their passwords.                        ![[Pasted image 20231229161133.png]]
	- Upon changing their passwords, we can login into their mailboxes and retrieve emails using `pop3`.![[Pasted image 20231229174549.png]]Within one of the emails for `mindy`, one can locate a set of SSH credentials.![[Pasted image 20231229174810.png]]
	- `JAMES Remote Administration Tool` also suffers from a Authenticated RCE but the code only executes when the next time a user logs in (i.e. via SSH). However, the vulnerability does not grant us initial access but can help us break out of the restricted bash session that SSH provides.
#### Attack Path
- <mark>Exploitation</mark>
	- Login through SSH as `mindy` using the password `P@55W0rd1!2@` found within the email.                                                       ![[Pasted image 20231229175402.png]] 
	- Upon trying to switch directory, one can identify the session is restricted with `rbash` like mentioned in one of the emails. Looking at `/etc/passwd` further consolidates the fact.![[Pasted image 20231229180638.png]]
- <mark>Post-Exploitation</mark>
	- <mark>Breaking Free~~~</mark>
		- Use a [script](https://www.exploit-db.com/exploits/50347) that works out of the box to exploit the vulnerability and log in again using SSH to get a reverse shell callback.![[Pasted image 20231229181713.png]]
	- <mark>mindy => root</mark>
		- `pspy` will identify `/opt/tmp.py` which `mindy` has write permission is being regularly executed as with `root` privileges.![[Pasted image 20231229191314.png]]![[Pasted image 20231229191332.png]]
		- Rewrite the file with reverse shell payload and wait for callback.![[Pasted image 20231229192512.png]]![[Pasted image 20231229192451.png]]